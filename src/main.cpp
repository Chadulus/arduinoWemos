#include <Arduino.h>

// Function declaration
void playNote(int rate, float seconds);

// --- Note Frequency Map ---
#define NOTE_A4 440
#define NOTE_As4 466
#define NOTE_C4 262
#define NOTE_C5 523
#define NOTE_D4 294
#define NOTE_E4 330
#define NOTE_F4 349
#define NOTE_G4 392
#define REST 0

const int speakerPin = 12;

struct Note
{
  int frequency;
  float duration;
};

Note mySong[] = {
    {NOTE_F4, 0.75},
    {NOTE_G4, 1.25},
    {NOTE_C4, 0.53},
    {NOTE_G4, 0.75},
    {NOTE_A4, 0.75},
    {NOTE_C5, 0.13},
    {NOTE_As4, 0.13},
    {NOTE_A4, 0.26},
    {NOTE_F4, 0.75},
    {NOTE_G4, 1.25},
    {NOTE_C4, 1.31},
    {REST, 0.53},
    {NOTE_C4, 0.13},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.13},
    {NOTE_F4, 0.75},
    {NOTE_G4, 1.25},
    {NOTE_C4, 0.53},
    {NOTE_G4, 0.75},
    {NOTE_A4, 0.75},
    {NOTE_C5, 0.13},
    {NOTE_As4, 0.13},
    {NOTE_A4, 0.26},
    {NOTE_F4, 0.75},
    {NOTE_G4, 1.25},
    {NOTE_C4, 1.31},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_F4, 0.53},
    {REST, 0.53},
    {NOTE_F4, 0.13},
    {NOTE_F4, 0.26},
    {NOTE_F4, 0.13},
    {REST, 0.53},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 1.31},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_C5, 0.26},
    {REST, 0.26},
    {NOTE_C5, 0.26},
    {NOTE_G4, 1.05},
    {REST, 0.53},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {REST, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.79},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {REST, 0.53},
    {NOTE_F4, 1.31},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_C4, 0.53},
    {REST, 1.05},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {REST, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {REST, 1.05},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 1.31},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_C5, 0.26},
    {REST, 0.26},
    {NOTE_C5, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_F4, 0.26},
    {REST, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {REST, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.79},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {REST, 0.53},
    {NOTE_F4, 1.31},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_C4, 0.53},
    {REST, 1.05},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {REST, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {REST, 0.53},
    {NOTE_C4, 2.10},
    {NOTE_F4, 0.39},
    {NOTE_F4, 0.13},
    {REST, 0.26},
    {NOTE_E4, 0.26},
    {REST, 1.05},
    {NOTE_C4, 2.10},
    {NOTE_F4, 0.39},
    {NOTE_F4, 0.13},
    {REST, 0.26},
    {NOTE_E4, 0.26},
    {REST, 1.58},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 1.31},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_C5, 0.26},
    {REST, 0.26},
    {NOTE_C5, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_F4, 0.26},
    {REST, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {REST, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.79},
    {REST, 0.79},
    {NOTE_D4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {REST, 0.53},
    {NOTE_F4, 1.31},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_C4, 0.53},
    {REST, 1.05},
    {NOTE_D4, 0.26},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.26},
    {NOTE_D4, 0.26},
    {REST, 0.26},
    {NOTE_G4, 0.26},
    {NOTE_A4, 0.26},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_G4, 0.39},
    {NOTE_G4, 0.39},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_A4, 0.39},
    {NOTE_A4, 0.39},
    {NOTE_G4, 0.79},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_C5, 0.53},
    {NOTE_E4, 0.26},
    {NOTE_F4, 0.39},
    {NOTE_E4, 0.13},
    {NOTE_D4, 0.26},
    {NOTE_C4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.13},
    {NOTE_D4, 0.13},
    {NOTE_F4, 0.53},
    {NOTE_G4, 0.26},
    {NOTE_E4, 0.39},
    {NOTE_D4, 0.13},
    {NOTE_C4, 0.53},
    {NOTE_C4, 0.26},
    {NOTE_G4, 0.53},
    {NOTE_F4, 1.05}};

int songLength = sizeof(mySong) / sizeof(mySong[0]);

void setup()
{
  pinMode(speakerPin, OUTPUT);
}

void loop()
{
  for (int i = 0; i < songLength; i++)
  {
    if (mySong[i].frequency > 0)
    {
      playNote(mySong[i].frequency, mySong[i].duration * 0.8);
    }
    else
    {
      delay(mySong[i].duration * 1000); // 1000);
    }
    delay(20); // Small gap for clarity
  }
  delay(3000);
}

void playNote(int rate, float seconds)
{
  if (rate <= 0)
    return;
  long p_rate = 1000000 / (rate * 2);
  long cycles = (seconds * 1000000) / (p_rate * 2);

  for (long i = 0; i < cycles; i++)
  {
    digitalWrite(speakerPin, HIGH);
    delayMicroseconds(p_rate);
    digitalWrite(speakerPin, LOW);
    delayMicroseconds(p_rate);
  }
}
